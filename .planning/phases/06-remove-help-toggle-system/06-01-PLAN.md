---
phase: 06-remove-help-toggle-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - swift/Ruler/Sources/Ruler.swift
autonomous: true

must_haves:
  truths:
    - "No UserDefaults persistence related to hint bar dismissal exists anywhere in codebase"
    - "Hint bar visibility controlled exclusively by hideHintBar preference parameter"
    - "No dead code or unused constants related to the old help toggle system remain"
  artifacts:
    - path: "swift/Ruler/Sources/Ruler.swift"
      provides: "Clean run() with no UserDefaults toggle artifacts"
      contains: "func run(hideHintBar:"
  key_links: []
---

<objective>
Remove the last remnants of the Phase 5 help toggle system from Ruler.swift.

The bulk of the help toggle system (backspace dismiss, "?" re-enable, transient help message,
backspace KeyID) was already removed in commit `fa1544a`. Two artifacts remain in Ruler.swift:

1. `kHintBarDismissedKey` constant (line 4) — now unused
2. `if hideHintBar { UserDefaults.standard.removeObject(...) }` block (lines 33-37) — clears
   a UserDefaults key that is never written anymore

Purpose: Complete the removal so the codebase has zero references to the old toggle system.
Output: Clean Ruler.swift with hideHintBar preference as the only hint bar control.
</objective>

<execution_context>
@/Users/haythem/.claude/get-shit-done/workflows/execute-plan.md
@/Users/haythem/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@swift/Ruler/Sources/Ruler.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead help toggle artifacts from Ruler.swift</name>
  <files>swift/Ruler/Sources/Ruler.swift</files>
  <action>
In `swift/Ruler/Sources/Ruler.swift`:

1. Delete line 4: `private let kHintBarDismissedKey = "com.raycast.design-ruler.hintBarDismissed"`
   (and the blank line after it if one exists, to keep spacing clean)

2. Delete the 5-line block in `run()` (lines 33-37):
   ```swift
   // When hideHintBar is toggled on, clear the backspace-dismiss flag
   // so toggling the preference off→on→off re-enables the hint bar
   if hideHintBar {
       UserDefaults.standard.removeObject(forKey: kHintBarDismissedKey)
   }
   ```

3. Verify no other references to `kHintBarDismissedKey`, `hintBarDismissed`, `UserDefaults`,
   or `backspace` remain anywhere under `swift/Ruler/Sources/`.

4. Run `swift build` from `swift/Ruler/` to confirm clean compilation.
  </action>
  <verify>
- `grep -r "kHintBarDismissedKey\|hintBarDismissed\|UserDefaults\|backspace" swift/Ruler/Sources/` returns nothing
- `cd swift/Ruler && swift build` succeeds with no errors
  </verify>
  <done>
Ruler.swift has zero references to the old help toggle system. The only mechanism controlling
hint bar visibility is the `hideHintBar` Bool parameter passed from TypeScript. Build succeeds.
  </done>
</task>

</tasks>

<verification>
1. `grep -rn "kHintBarDismissedKey\|hintBarDismissed\|UserDefaults\|backspace\|transientHelp\|helpGeneration\|showHintBar\|showTransient" swift/Ruler/Sources/` — zero results
2. `cd swift/Ruler && swift build` — clean build, no errors or warnings related to this change
3. Hint bar still appears when `hideHintBar=false` (controlled by preference only)
</verification>

<success_criteria>
- Zero references to UserDefaults, kHintBarDismissedKey, or backspace in swift/Ruler/Sources/
- Swift build passes
- Ruler.swift run() method has no help-toggle logic — hideHintBar parameter flows straight to RulerWindow.create()
</success_criteria>

<output>
After completion, create `.planning/phases/06-remove-help-toggle-system/06-01-SUMMARY.md`
</output>
